<?xml version="1.0" encoding="ISO-8859-1"?>
<!--

    Copyright (C) 2009 eXo Platform SAS.
    
    This is free software; you can redistribute it and/or modify it
    under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation; either version 2.1 of
    the License, or (at your option) any later version.
    
    This software is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public
    License along with this software; if not, write to the Free
    Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
    02110-1301 USA, or see the FSF site: http://www.fsf.org.

-->

<configuration
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.exoplatform.org/xml/ns/kernel_1_2.xsd http://www.exoplatform.org/xml/ns/kernel_1_2.xsd"
   xmlns="http://www.exoplatform.org/xml/ns/kernel_1_2.xsd">

  <external-component-plugins>
    <target-component>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.EmailNotificationService</target-component>
    <component-plugin>
          <name>UserJoinTenantNotificationPlugin</name>
          <set-method>addNotificationPlugin</set-method>
          <type>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.plugins.UserJoinTenant.UserJoinTenantNotificationPlugin</type>
          <description>User joins tenant notification plugin</description>      
    </component-plugin>
    <component-plugin>
          <name>ConnectionNotificationPlugin</name>
          <set-method>addNotificationPlugin</set-method>
          <type>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.plugins.ConnectionNotificationPlugin</type>
          <description>Connection request notification plugin</description>    
    </component-plugin>
    <component-plugin>
          <name>SpaceNotificationPlugin</name>
          <set-method>addNotificationPlugin</set-method>
          <type>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.plugins.SpaceNotificationPlugin</type>
          <description>Space request notification plugin</description>      
    </component-plugin>
    <component-plugin>
          <name>RequestToJoinSpacePlugin</name>
          <set-method>addNotificationPlugin</set-method>
          <type>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.plugins.RequestToJoinSpacePlugin</type>
          <description>Request to join space plugin</description>      
    </component-plugin>
  </external-component-plugins>
  
  <external-component-plugins>
    <target-component>org.exoplatform.services.organization.OrganizationService</target-component>
    <component-plugin>
      <name>new.user.created.listener</name>
      <set-method>addListenerPlugin</set-method>
      <type>com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.plugins.UserJoinTenant.UserJoinTenantListener</type>
      <description>this listener notifies tenant's admin when a new user joined </description>
    </component-plugin>
  </external-component-plugins>
  
  <external-component-plugins>
    <target-component>org.exoplatform.services.scheduler.JobSchedulerService</target-component>
    <component-plugin>
      <name>AddCronJob</name>
      <set-method>addCronJob</set-method>
      <type>org.exoplatform.services.scheduler.CronJob</type>
      <description>add a cron job to the JobSchedulerService</description>
      <init-params>
        <properties-param>
          <name>cronjob.info</name>
          <description>Email notification job</description>
          <property name="jobName" value="EmailNotificationJob" />
          <property name="groupName" value="EmailNotificationJobGroup" />
          <property name="job" value="com.exoplatform.cloudworkspaces.gadget.services.EmailNotification.EmailNotificationJob" />
          <property name="expression" value="0 * * * * ?" />
        </properties-param>
      </init-params>
    </component-plugin>
  </external-component-plugins>

  <external-component-plugins>
    <target-component>org.exoplatform.services.cache.CacheService</target-component>
    <component-plugin>
      <name>addExoCacheConfig</name>
      <set-method>addExoCacheConfig</set-method>
      <type>org.exoplatform.services.cache.ExoCacheConfigPlugin</type>
      <description></description>
      <init-params>
        <object-param>
          <name>EmailNotificationsCache</name>
          <description></description>
          <object type="org.exoplatform.services.cache.ExoCacheConfig">
            <field name="name"><string>EmailNotificationsCache</string></field>
            <field name="maxSize"><int>${cache.exo.cloud.EmailNotificationsCache.Capacity:100000}</int></field>
            <field name="liveTime"><long>${cache.exo.cloud.EmailNotificationsCache.TimeToLive:-1}</long></field>
            <field name="implementation"><string>org.exoplatform.services.cache.concurrent.ConcurrentFIFOExoCache</string></field>
          </object>
        </object-param>
      </init-params>
    </component-plugin>
    <component-plugin profiles="cluster">
      <name>addExoCacheConfig</name>
      <set-method>addExoCacheConfig</set-method>
      <type>org.exoplatform.services.cache.ExoCacheConfigPlugin</type>
      <description>add Exo Cache Config</description>
      <init-params>
        <object-param>
          <name>EmailNotificationsCache</name>
          <description>The JBoss Cache configuration for the IdentityCache</description>
          <object
            type="org.exoplatform.services.cache.impl.jboss.ea.EAExoCacheConfig">
            <field name="name"><string>EmailNotificationsCache</string></field>
            <field name="expirationTimeout"><long>${cache.exo.cloud.EmailNotificationsCache.TimeToLive:-1}</long></field>
            <field name="maxNodes"><int>${cache.exo.cloud.EmailNotificationsCache.Capacity:100000}</int></field>
            <field name="distributed"><boolean>true</boolean></field>
          </object>
        </object-param>
      </init-params>
    </component-plugin>
  </external-component-plugins>
    
</configuration>
